package seleniumJava;

import java.text.SimpleDateFormat;
import java.util.Date;
import java.util.List;
import java.util.Random;
import org.junit.After;
import org.junit.Before;
import org.openqa.selenium.By;
import org.openqa.selenium.WebDriver;
import org.openqa.selenium.WebElement;
import org.openqa.selenium.chrome.ChromeDriver;
import org.openqa.selenium.support.ui.*;


public class Test {

	WebDriver driver;
	SimpleDateFormat df1 = new SimpleDateFormat("MMddHHmmss");
	String time = df1.format(new Date());
	SimpleDateFormat df2 = new SimpleDateFormat("yyyy-MM-dd");
	String date = df2.format(new Date());
	SimpleDateFormat df3 = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss");
	String date1 = df3.format(new Date());
	Random random = new Random();
	

	@Before
	public void before() {
		login();
	}

	@After
	public void after() {
		driver.quit();
	}

	public void login() {
		// WebDriver driver = new FirefoxDriver();
		driver = new ChromeDriver();
		// WebDriver driver = new EdgeDriver();
		driver.get("http://examtest.newgs.net/index.php/Admin/Login/index");
		driver.manage().window().maximize();
		WebElement username = driver.findElement(By.id("username"));
		WebElement password = driver.findElement(By.id("password"));
		WebElement vcode = driver.findElement(By.id("vcode"));
		WebElement submit = driver.findElement(By.id("submit"));
		username.sendKeys("ksadmin");
		password.sendKeys("ksadmin123");
		vcode.sendKeys("1233");
		submit.click();
	}

	@org.junit.Test
	public void 模块列表() throws InterruptedException {
		List<WebElement> nav = driver.findElements(By.cssSelector("#side-menu > li"));
		for (int i = 1; i < nav.size(); i++) {
			List<WebElement> tag = driver.findElements(By.cssSelector("#side-menu > li > ul > li"));
			switch (nav.get(i).getText()) {
			case "模考管理":
				System.out.println( nav.get(i).getText());
				nav.get(i).click();
				Thread.sleep(3000);
				for (int j = 0; j < tag.size(); j++) {
					if (!tag.get(j).getText().equals("")) {
						System.out.println(j + "...." + tag.get(j).getText());
						tag.get(j).click();
						Thread.sleep(1000);
					}
				}
				break;
			case "运营审核":
				System.out.println(nav.get(i).getText());
				nav.get(i).click();
				Thread.sleep(3000);
				for (int j = 0; j < tag.size(); j++) {
					if (!tag.get(j).getText().equals("")) {
						System.out.println(j + "...." + tag.get(j).getText());
						tag.get(j).click();
						Thread.sleep(1000);
					}
				}
				break;
			case "产品销售":
				System.out.println( nav.get(i).getText());
				nav.get(i).click();
				Thread.sleep(3000);
				for (int j = 0; j < tag.size(); j++) {
					if (!tag.get(j).getText().equals("")) {
						System.out.println(j + "...." + tag.get(j).getText());
						tag.get(j).click();
						Thread.sleep(1000);
					}
				}
				break;
			case "运营试卷":
				System.out.println( nav.get(i).getText());
				nav.get(i).click();
				Thread.sleep(3000);
				for (int j = 0; j < tag.size(); j++) {
					if (!tag.get(j).getText().equals("")) {
						System.out.println(j + "...." + tag.get(j).getText());
						tag.get(j).click();
						Thread.sleep(1000);
					}
				}
				break;
			case "教研模块":
				System.out.println(nav.get(i).getText());
				nav.get(i).click();
				Thread.sleep(3000);
				for (int j = 0; j < tag.size(); j++) {
					if (!tag.get(j).getText().equals("")) {
						System.out.println(j + "...." + tag.get(j).getText());
						tag.get(j).click();
						Thread.sleep(1000);
					}
				}
				break;
			case "公客模块":
				System.out.println( nav.get(i).getText());
				nav.get(i).click();
				Thread.sleep(3000);
				for (int j = 0; j < tag.size(); j++) {
					if (!tag.get(j).getText().equals("")) {
						System.out.println(j + "...." + tag.get(j).getText());
						tag.get(j).click();
						Thread.sleep(1000);
					}
				}
				break;
			case "权限模块":
				System.out.println(nav.get(i).getText());
				nav.get(i).click();
				Thread.sleep(3000);
				for (int j = 0; j < tag.size(); j++) {
					if (!tag.get(j).getText().equals("")) {
						System.out.println(j + "...." + tag.get(j).getText());
						tag.get(j).click();
						Thread.sleep(1000);
					}
				}
				break;
			case "专题特卖":
				System.out.println( nav.get(i).getText());
				nav.get(i).click();
				Thread.sleep(3000);
				for (int j = 0; j < tag.size(); j++) {
					if (!tag.get(j).getText().equals("")) {
						System.out.println(j + "...." + tag.get(j).getText());
						tag.get(j).click();
						Thread.sleep(1000);
					}
				}
				break;
			default:
				break;
			}
		}
	}
	
	
	@org.junit.Test
	public void 添加学员() throws InterruptedException{
		WebElement 模考管理 = driver.findElement(By.cssSelector("#side-menu > li:nth-child(2) > a"));
		模考管理.click();
		WebElement 学员列表 = driver.findElement(By.cssSelector("#side-menu > li.active > ul > li:nth-child(1) > a"));
		学员列表.click();
		driver.switchTo().frame(driver.findElement(By.xpath("//*[@id='content-main']/iframe[2]")));
		WebElement 添加学员 = driver.findElement(By.xpath("//*[@id='bodymain']/div/div/div/div/div[2]/div[1]/div[1]/a[1]/span"));
		添加学员.click();
		WebElement 姓名 = driver.findElement(By.cssSelector("#name"));
		WebElement 电话  = driver.findElement(By.cssSelector("#phone"));
		WebElement 邮箱 = driver.findElement(By.cssSelector("#email"));
		姓名.clear();
		电话.clear();
		邮箱.clear();
		姓名.sendKeys("姓名"+time);
		电话.sendKeys("1"+time);
		邮箱.sendKeys("123@qq.com");
		WebElement 确认 = driver.findElement(By.xpath("//*[@id='signupForm']/div[6]/div/button"));
		确认.click();
		Thread.sleep(1000);
		WebElement 查找 = driver.findElement(By.cssSelector("#bodymain > div > div > div > div > div.ibox-content > div:nth-child(1) > div:nth-child(2) > div > input"));
		查找.clear();
		查找.sendKeys("1"+time);
		WebElement 搜索 = driver.findElement(By.cssSelector("#bodymain > div > div > div > div > div.ibox-content > div:nth-child(1) > div:nth-child(2) > div > span > input"));
		搜索.click();
		Thread.sleep(2000);
		driver.switchTo().defaultContent();
	}
	
	
	@org.junit.Test
	public void 添加分校() throws InterruptedException{
		WebElement 模考管理 = driver.findElement(By.cssSelector("#side-menu > li:nth-child(2) > a"));
		模考管理.click();
		Thread.sleep(1000);
		WebElement 分校管理 = driver.findElement(By.cssSelector("#side-menu > li.active > ul > li:nth-child(2) > a"));
		分校管理.click();
		driver.switchTo().frame(driver.findElement(By.xpath("//*[@id='content-main']/iframe[2]")));
		Thread.sleep(2000);
		WebElement 添加分校 = driver.findElement(By.cssSelector("#bodymain > div > div > div > div > div.ibox-content > div:nth-child(1) > div > a > span"));
		添加分校.click();
		Thread.sleep(1000);
		WebElement 分校名称 = driver.findElement(By.cssSelector("#signupForm > div:nth-child(2) > div > input"));
		分校名称.clear();
		分校名称.sendKeys("分校"+time);
		WebElement 状态 = driver.findElement(By.cssSelector("#signupForm > div:nth-child(5) > div > label:nth-child(1)"));
		状态.click();
		WebElement 确认 = driver.findElement(By.cssSelector("#signupForm > div:nth-child(6) > div > button"));
		确认.click();
		driver.switchTo().defaultContent();
	}
	
	@org.junit.Test
	public void 添加模考() throws InterruptedException{
		WebElement 模考管理 = driver.findElement(By.cssSelector("#side-menu > li:nth-child(2) > a"));
		模考管理.click();
		Thread.sleep(1000);
		WebElement 模考列表 = driver.findElement(By.cssSelector("#side-menu > li.active > ul > li:nth-child(3) > a"));
		模考列表.click();
		driver.switchTo().frame(driver.findElement(By.cssSelector("#content-main > iframe:nth-child(2)")));
		Thread.sleep(2000);
		WebElement 添加模考 = driver.findElement(By.cssSelector("#bodymain > div > div > div > div > div.ibox-content > div:nth-child(1) > div > a"));
		添加模考.click();
		Thread.sleep(1000);
		WebElement 分校名称 = driver.findElement(By.cssSelector("#signupForm > div:nth-child(3) > div > div > a > span"));
		分校名称.click();
		WebElement 选择分校 = driver.findElement(By.cssSelector("#signupForm > div:nth-child(3) > div > div > div > ul > li:nth-child(2)"));
		选择分校.click();
		WebElement 模考时间 = driver.findElement(By.cssSelector("#mock_time"));
		模考时间.sendKeys(date);
		WebElement 模考名称 = driver.findElement(By.cssSelector("#signupForm > div:nth-child(5) > div > input"));
		模考名称.sendKeys("模考"+date1);
		WebElement 模考次序 = driver.findElement(By.cssSelector("#signupForm > div:nth-child(6) > div > div > a > span"));
		模考次序.click();
		int i = random.nextInt(5)+2;
		WebElement 选择次序 = driver.findElement(By.cssSelector("#signupForm > div:nth-child(6) > div > div > div > ul > li:nth-child("+i+")"));
		选择次序.click();
		WebElement 套餐类型 = driver.findElement(By.cssSelector("#signupForm > div:nth-child(7) > div > div > a > span"));
		套餐类型.click();
		int j = random.nextInt(4)+2;
		WebElement 选择类型 = driver.findElement(By.cssSelector("#signupForm > div:nth-child(7) > div > div > div > ul > li:nth-child("+j+")"));
		选择类型.click();
		WebElement 选择标签 = driver.findElement(By.xpath(".//*[@id='mockSelectConTag_chosen']/ul/li/input"));
		选择标签.click();
		int k = random.nextInt(11)+1;
		WebElement 标签 = driver.findElement(By.xpath(".//*[@id='mockSelectConTag_chosen']/div/ul/li["+k+"]"));
		标签.click();
		WebElement 选择套餐 = driver.findElement(By.cssSelector("#signupForm > div:nth-child(10) > div > div > a > span"));
		选择套餐.click();
		WebElement 套餐名称 = driver.findElement(By.xpath(".//*[@id='signupForm']/div[8]/div/div/div/ul/li[14]"));
		套餐名称.click();
		WebElement 状态 = driver.findElement(By.cssSelector("#signupForm > div:nth-child(14) > div > label:nth-child(1)"));
		状态.click();
		WebElement 确认 = driver.findElement(By.cssSelector("#signupForm > div:nth-child(15) > div > button"));
		确认.click();
		driver.switchTo().defaultContent();
		
		Thread.sleep(2000);
		driver.switchTo().frame(driver.findElement(By.xpath("//*[@id='content-main']/iframe[2]")));
		WebElement 选择增值服务 = driver.findElement(By.xpath(".//*[@id='zzfw_product_id_chosen']/a/span"));
		选择增值服务.click();
		WebElement 增值服务 = driver.findElement(By.xpath(".//*[@id='zzfw_product_id_chosen']/div/ul/li[4]"));
		增值服务.click();
		Thread.sleep(1000);
		WebElement 确定 = driver.findElement(By.xpath(".//*[@id='do_add_zzfw']"));
		确定.click();
		WebElement sure = driver.findElement(By.xpath("//*[@id='xubox_layer1']/div[1]/span[2]/a[1]"));
		sure.click();
		
		Thread.sleep(2000);
		WebElement 负责人 = driver.findElement(By.xpath(".//*[@id='bodymain']/div[1]/div/div[1]/div/div/div[2]/div[3]/div[2]/div/button"));
		负责人.click();
		driver.switchTo().defaultContent();
		Thread.sleep(1000);
		driver.switchTo().frame(driver.findElement(By.xpath("//*[@id='content-main']/iframe[2]")));
		WebElement 姓名 = driver.findElement(By.xpath(".//*[@id='contacts_name']"));
		姓名.sendKeys("测试");
		WebElement 手机号码 = driver.findElement(By.xpath("//*[@id='contacts_mobile']"));
		手机号码.sendKeys("13000000000");
		WebElement 邮箱号码 = driver.findElement(By.xpath("//*[@id='contacts_email']"));
		邮箱号码.sendKeys("123@123.com");
		WebElement 保存 = driver.findElement(By.xpath("//*[@id='addContactsModalForm']/div/div[3]/button[2]"));
		保存.click();
		Thread.sleep(3000);
		driver.switchTo().defaultContent();
		
		driver.switchTo().frame(driver.findElement(By.cssSelector("#content-main > iframe:nth-child(2)")));
		WebElement 返回 = driver.findElement(By.xpath("//*[@id='bodymain']/div[1]/div/div[1]/div/div/div[1]/button"));
		返回.click();
		driver.switchTo().defaultContent();
		
//		Thread.sleep(3000);
//		driver.switchTo().frame(driver.findElement(By.cssSelector("#content-main > iframe:nth-child(2)")));
//		Select s1 = new Select(driver.findElement(By.xpath(".//*[@id='ss_os_id']")));
//		s1.selectByIndex(1);
//		WebElement 模考名称搜索 = driver.findElement(By.xpath(".//*[@id='ss_mock_name']"));
//		模考名称搜索.sendKeys("模考"+date1);
//		
//		Thread.sleep(1000);
//		WebElement 搜索 = driver.findElement(By.xpath(".//*[@id='search_form']/div[4]/div/a/span"));
//		搜索.click();
//		
//		Thread.sleep(10000);
//		driver.switchTo().defaultContent();
	}
	
	@org.junit.Test
	public void 运营试卷() throws InterruptedException{
		WebElement 运营试卷  = driver.findElement(By.xpath("//*[@id='side-menu']/li[5]/a"));
		运营试卷.click();
		Thread.sleep(1000);
		
//		WebElement 标签 = driver.findElement(By.cssSelector("#side-menu > li.active > ul > li:nth-child(1) > a"));
//		标签.click();
//		driver.switchTo().frame(driver.findElement(By.cssSelector("#content-main > iframe:nth-child(2)")));
//		WebElement 添加标签 = driver.findElement(By.cssSelector("#bodymain > div > div > div > div > div.ibox-content > div:nth-child(1) > div > a"));
//		添加标签.click();
//		Thread.sleep(2000);
//		WebElement 标签名称 = driver.findElement(By.cssSelector("#signupForm > div:nth-child(2) > div > input"));
//		标签名称.sendKeys("标签-"+date1);
//		WebElement 标签确认 = driver.findElement(By.cssSelector("#signupForm > div:nth-child(3) > div > button"));
//		标签确认.click();
//		driver.switchTo().defaultContent();
		
		WebElement 题本 = driver.findElement(By.cssSelector("#side-menu > li.active > ul > li:nth-child(2) > a"));
		题本.click();
		driver.switchTo().frame(driver.findElement(By.xpath("//*[@id='content-main']/iframe[2]")));
		WebElement 添加题本 = driver.findElement(By.cssSelector("#bodymain > div > div > div > div > div.ibox-content > div:nth-child(1) > div > a"));
		添加题本.click();
		WebElement 题本标题 = driver.findElement(By.cssSelector("#signupForm > div:nth-child(2) > div > input"));
		题本标题.sendKeys("题本-"+date1);
		WebElement 新增材料 = driver.findElement(By.cssSelector("#signupForm > div:nth-child(4) > div > a"));
		for (int i = 1; i < 7; i++) {
			新增材料.click();
			Thread.sleep(3000);
			switch (i) {
			case 1:
				WebElement 材料标题1 = driver.findElement(By.cssSelector("#cailiao > div:nth-child(1) > input"));
				材料标题1.sendKeys("材料一");
				driver.switchTo().frame(driver.findElement(By.cssSelector("#cailiao > div:nth-child(2) > div > div.ke-edit > iframe")));
				WebElement 材料内容1 = driver.findElement(By.cssSelector("body"));
				材料内容1.sendKeys("    1.材料一的内容材料一的内容材料一的内容材料一的内容材料一的内容材料一的内容材料一的内容材料一的内容材料一的内容。\n    2.材料一的内容。");
				driver.switchTo().parentFrame();
				break;
			case 2:
				WebElement 材料标题2 = driver.findElement(By.cssSelector("#cailiao > div:nth-child(5) > input"));
				材料标题2.sendKeys("材料二");
				driver.switchTo().frame(driver.findElement(By.cssSelector("#cailiao > div:nth-child(6) > div > div.ke-edit > iframe")));
				WebElement 材料内容2 = driver.findElement(By.cssSelector("body"));
				材料内容2.sendKeys("    1.材料二的内容材料二的内容材料二的内容材料二的内容材料二的内容材料二的内容材料二的内容材料二的内容材料二的内容。\n    2.材料二的内容。");
				driver.switchTo().parentFrame();			
				break;
			case 3:
				WebElement 材料标题3 = driver.findElement(By.cssSelector("#cailiao > div:nth-child(9) > input"));
				材料标题3.sendKeys("材料三");
				driver.switchTo().frame(driver.findElement(By.cssSelector("#cailiao > div:nth-child(10) > div > div.ke-edit > iframe")));
				WebElement 材料内容3 = driver.findElement(By.cssSelector("body"));
				材料内容3.sendKeys("    1.材料三的内容材料三的内容材料三的内容材料三的内容材料三的内容材料三的内容材料三的内容材料三的内容材料三的内容。\n    2.材料三的内容。");
				driver.switchTo().parentFrame();
				break;
			case 4:
				WebElement 材料标题4 = driver.findElement(By.cssSelector("#cailiao > div:nth-child(13) > input"));
				材料标题4.sendKeys("材料四");
				driver.switchTo().frame(driver.findElement(By.cssSelector("#cailiao > div:nth-child(14) > div > div.ke-edit > iframe")));
				WebElement 材料内容4 = driver.findElement(By.cssSelector("body"));
				材料内容4.sendKeys("    1.材料四的内容材料四的内容材料四的内容材料四的内容材料四的内容材料四的内容材料四的内容材料四的内容材料四的内容。\n    2.材料四的内容。");
				driver.switchTo().parentFrame();
				break;
			case 5:
				WebElement 材料标题5 = driver.findElement(By.cssSelector("#cailiao > div:nth-child(17) > input"));
				材料标题5.sendKeys("材料五");
				driver.switchTo().frame(driver.findElement(By.cssSelector("#cailiao > div:nth-child(18) > div > div.ke-edit > iframe")));
				WebElement 材料内容5 = driver.findElement(By.cssSelector("body"));
				材料内容5.sendKeys("    1.材料五的内容材料五的内容材料五的内容材料五的内容材料五的内容材料五的内容材料五的内容材料五的内容材料五的内容。\n    2.材料五的内容。");
				driver.switchTo().parentFrame();
				break;
			case 6:
				WebElement 材料标题6 = driver.findElement(By.cssSelector("#cailiao > div:nth-child(21) > input"));
				材料标题6.sendKeys("材料六");
				driver.switchTo().frame(driver.findElement(By.cssSelector("#cailiao > div:nth-child(22) > div > div.ke-edit > iframe")));
				WebElement 材料内容6 = driver.findElement(By.cssSelector("body"));
				材料内容6.sendKeys("    1.材料六的内容材料六的内容材料六的内容材料六的内容材料六的内容材料六的内容材料六的内容材料六的内容材料六的内容。\n    2.材料六的内容。");
				driver.switchTo().parentFrame();
				break;
			}
		}
		
		Thread.sleep(8000);
	}
}
