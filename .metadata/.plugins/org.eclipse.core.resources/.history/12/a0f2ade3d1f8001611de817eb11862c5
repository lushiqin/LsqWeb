package seleniumJava;

import java.text.SimpleDateFormat;
import java.util.Calendar;
import java.util.Date;
import java.util.List;

import org.junit.After;
import org.junit.Before;
import org.junit.Test;
import org.omg.CORBA.DATA_CONVERSION;
import org.openqa.selenium.By;
import org.openqa.selenium.WebDriver;
import org.openqa.selenium.WebElement;
import org.openqa.selenium.chrome.ChromeDriver;
import org.openqa.selenium.edge.EdgeDriver;
import org.openqa.selenium.firefox.FirefoxDriver;
import org.openqa.selenium.support.ui.*;

public class newgs {

//	 WebDriver driver = new FirefoxDriver();
	WebDriver driver = new ChromeDriver();
//	 WebDriver driver = new EdgeDriver();

	SimpleDateFormat df = new SimpleDateFormat("MMddHHmmss");
	
	Calendar c = Calendar.getInstance();
	int year = c.get(Calendar.YEAR);
	int month = c.get(Calendar.MONTH) + 1;
	int date = c.get(Calendar.DATE);
	int date1 = c.get(Calendar.DATE) + 1;
	int date2 = c.get(Calendar.DATE) + 3;
	int hour = c.get(Calendar.HOUR_OF_DAY);
	int minute = 30;
	int second = 30;
	

	String betime = year + "-" + month + "-" + date + " " + hour + ":" + minute + ":" + second;
	String endtime = year + "-" + month + "-" + date1 + " " + hour + ":" + minute + ":" + second;

	@Before
	public void before() throws InterruptedException {

		driver.get("http://scrmdev.newgs.net/login");
		driver.manage().window().maximize();
		login();
	}

	@After
	public void after() throws InterruptedException {
		Thread.sleep(5000);
		driver.quit();
	}

	/**
	 * 登陆
	 * 
	 * @throws InterruptedException
	 */
	public void login() throws InterruptedException {
		Thread.sleep(500);
		WebElement username = driver.findElement(By.xpath("/html/body/div[1]/div/div/form/div[1]/div/input"));
		WebElement password = driver.findElement(By.xpath("/html/body/div[1]/div/div/form/div[2]/div/input"));
		username.sendKeys("sale1@sale1.com");
		password.sendKeys("admin123");
		WebElement submit = driver.findElement(By.xpath("/html/body/div[1]/div/div/form/div[3]/button"));
		submit.click();
		Thread.sleep(1000);
	}

	/**
	 * 工作台
	 * 
	 * @throws InterruptedException
	 */
	@Test
	public void Workbench() throws InterruptedException {

		WebElement work1 = driver.findElement(By.xpath("//*[@id='navbar']/ul[1]/li[1]/a"));
		work1.click();
		WebElement workmoreac = driver.findElement(By.cssSelector("#page-wrapper > div.wrapper.wrapper-content > div.row.ny-activitys > div > div > div:nth-child(1) > div.ibox-title > div > a"));
		workmoreac.click();
		activitySend();
		
		WebElement work11 = driver.findElement(By.xpath("//*[@id='navbar']/ul[1]/li[1]/a"));
		work11.click();
		List<WebElement> workmonth = driver.findElements(
				By.xpath("//*[@id='page-wrapper']/div[2]/div[2]/div/div/div[1]/div[2]/div/div/div/table/tbody/tr"));
		int worksize = workmonth.size();
		for (int i = 0; i < worksize; i++) {
			List<WebElement> workdate = workmonth.get(i).findElements(By.tagName("td"));
			int workdatesize = workdate.size();
			for (int j = 0; j < workdatesize; j++) {
				workdate.get(j).click();
				Thread.sleep(5000);
			}
			Thread.sleep(1000);

		}

		Thread.sleep(1000);
		WebElement work2 = driver.findElement(By.xpath("//*[@id='navbar']/ul[1]/li[2]/a"));
		work2.click();
		WebElement createCustomer = driver
				.findElement(By.xpath("//*[@id='page-wrapper']/div[2]/div/div/div/div/div[1]/div[2]/a"));
		createCustomer.click();
		customerSend();
		
		Thread.sleep(1000);
		WebElement work3 = driver.findElement(By.xpath("//*[@id='navbar']/ul[1]/li[3]/a"));
		work3.click();
		WebElement createClass = driver.findElement(By.xpath("//*[@id='page-wrapper']/div[2]/div/div[1]/a[2]"));
		createClass.click();
		classSend();
		//创建作业
		WebElement className = driver.findElement(By.cssSelector("#tab-1 > div > div > table > tbody:nth-child(3) > tr:nth-child(1) > td:nth-child(1)"));
		className.click();
		WebElement classTask = driver.findElement(By.cssSelector("#page-wrapper > div.row.classes-show > div > div > div > div.row.m-t-sm > div > div > div.panel-heading > div > ul > li:nth-child(2) > a"));
		classTask.click();
		WebElement createTask = driver.findElement(By.cssSelector("#tab-3 > div.row.m-b-sm.m-t-sm > div.col-md-7.create-homework > a"));
		createTask.click();
		taskSend();
		
		Thread.sleep(1000);
		WebElement work4 = driver.findElement(By.xpath("//*[@id='navbar']/ul[1]/li[4]/a"));
		work4.click();
		WebElement createActivity = driver
				.findElement(By.xpath("//*[@id='page-wrapper']/div[2]/div/div/div/div/div[1]/div[2]/a"));
		createActivity.click();
//		activitySend();

	}

	/**
	 * 客戶 管理添加客户功能
	 * 
	 * @throws InterruptedException
	 */
	@Test
	public void Customer() throws InterruptedException {
		WebElement Customer = driver.findElement(By.xpath("//*[@id='navbar']/ul[1]/li[2]/a"));
		Customer.click();
		Thread.sleep(1000);
		WebElement createCustomer = driver
				.findElement(By.xpath("//*[@id='page-wrapper']/div[2]/div/div/div/div/div[1]/div[2]/a"));
		createCustomer.click();

		customerSend();
	}

	/**
	 * 活动管理添加活动功能
	 * 
	 * @throws InterruptedException
	 */
	@Test
	public void Activity() throws InterruptedException {
		WebElement Activity = driver.findElement(By.xpath("//*[@id='navbar']/ul[1]/li[4]/a"));
		Activity.click();
		Thread.sleep(1000);
		WebElement createActivity = driver
				.findElement(By.xpath("//*[@id='page-wrapper']/div[2]/div/div/div/div/div[1]/div[2]/a"));
		createActivity.click();

		activitySend();
	}

	/**
	 * 班级管理添加班级功能
	 * 
	 * @throws InterruptedException
	 */
	@Test
	public void Class() throws InterruptedException {
		WebElement Class = driver.findElement(By.xpath("//*[@id='navbar']/ul[1]/li[3]/a"));
		Class.click();
		Thread.sleep(1000);
		WebElement createClass = driver.findElement(By.xpath("//*[@id='page-wrapper']/div[2]/div/div[1]/a[2]"));
		createClass.click();

		classSend();
		
		//创建作业
		WebElement className = driver.findElement(By.cssSelector("#tab-1 > div > div > table > tbody:nth-child(3) > tr:nth-child(1) > td:nth-child(1)"));
		className.click();
		WebElement classTask = driver.findElement(By.cssSelector("#page-wrapper > div.row.classes-show > div > div > div > div.row.m-t-sm > div > div > div.panel-heading > div > ul > li:nth-child(2) > a"));
		classTask.click();
		WebElement createTask = driver.findElement(By.cssSelector("#tab-3 > div.row.m-b-sm.m-t-sm > div.col-md-7.create-homework > a"));
		createTask.click();
		taskSend();
	}

	/**
	 * 添加客户页面
	 * 
	 * @throws InterruptedException
	 */
	public void customerSend() throws InterruptedException {

		WebElement customerNice = driver.findElement(By.xpath("//*[@id='signupForm']/div[1]/div[1]/input"));
		WebElement customerPhone = driver.findElement(By.xpath("//*[@id='signupForm']/div[1]/div[2]/input[1]"));
		WebElement customerName = driver.findElement(By.xpath("//*[@id='signupForm']/div[2]/div[1]/input"));
		WebElement customerId = driver.findElement(By.xpath("//*[@id='id_no']"));
		WebElement customerSex = driver.findElement(By.xpath("//*[@id='sex']"));
		WebElement customerAge = driver.findElement(By.xpath("//*[@id='age']"));
		WebElement customerEmail = driver.findElement(By.xpath("//*[@id='signupForm']/div[4]/div[1]/input"));
		WebElement customerQQ = driver.findElement(By.xpath("//*[@id='qq']"));
		WebElement customerWechat = driver.findElement(By.xpath("//*[@id='wechat']"));
		WebElement customerCulture = driver.findElement(By.xpath("//*[@id='education']"));
		WebElement customerRegion = driver.findElement(By.xpath("//*[@id='favorite_block']"));
		WebElement customerPosition = driver.findElement(By.xpath("//*[@id='favorite_job']"));
		WebElement customerIndustry = driver.findElement(By.xpath("//*[@id='vocation']"));
		WebElement customerAddress = driver.findElement(By.xpath("//*[@id='address']"));
		WebElement customerFieldadd = driver.findElement(By.xpath("//*[@id='signupForm']/div[10]/div/button[1]"));
		WebElement customerLabeladd = driver.findElement(By.xpath("//*[@id='signupForm']/div[11]/div/button[1]"));
		WebElement customerSubmit = driver.findElement(By.xpath("//*[@id='signupForm']/div[12]/input"));

		customerNice.sendKeys("昵称-" + df.format(new Date()));
		customerPhone.sendKeys("1"+df.format(new Date()));
		customerName.sendKeys("名字-" + df.format(new Date()));
		customerId.sendKeys("1000000000000000012");
		customerSex.sendKeys("男");
		customerAge.sendKeys("15");
		customerEmail.sendKeys("666@qq.com");
		customerQQ.sendKeys("777888999");
		customerWechat.sendKeys("888888");
		customerCulture.sendKeys("博士");
		customerRegion.sendKeys("月球");
		customerPosition.sendKeys("星际漫游者");
		customerIndustry.sendKeys("无业游民");
		customerAddress.sendKeys("农村");

		customerFieldadd.click();
		Thread.sleep(1000);
		WebElement coustomerField = driver.findElement(By.xpath("//*[@id='field']/div/div/div[2]/div/input[1]"));
		WebElement coustomerField_val = driver.findElement(By.xpath("//*[@id='field']/div/div/div[2]/div/input[2]"));
		WebElement coustomerField_sub = driver.findElement(By.xpath("//*[@id='addField']"));
		coustomerField.sendKeys("字段" + date);
		coustomerField_val.sendKeys("字段内容" + date);
		coustomerField_sub.click();

		customerLabeladd.click();
		Thread.sleep(1000);
		WebElement coustomerLabel_val = driver.findElement(By.xpath("//*[@id='tag']/div/div/div[2]/div/input"));
		WebElement coustmoerLaber_sub = driver.findElement(By.xpath("//*[@id='addTag']"));
		coustomerLabel_val.sendKeys("标签" + date);
		coustmoerLaber_sub.click();

		customerSubmit.click();

	}

	/**
	 * 添加活动页面
	 * 
	 * @throws InterruptedException
	 */

	public void activitySend() throws InterruptedException {
		Thread.sleep(1000);
		WebElement activityName = driver.findElement(By.xpath("//*[@id='signupForm']/div[1]/div/input"));
		WebElement activityLabel = driver.findElement(By.xpath("//*[@id='myTags']/button"));
		WebElement activityBegin = driver.findElement(By.xpath("//*[@id='start_at']"));
		WebElement activityEnd = driver.findElement(By.xpath("//*[@id='end_at']"));
		WebElement activityContent = driver.findElement(By.xpath("//*[@id='signupForm']/div[5]/div/textarea"));
		WebElement activityRule = driver.findElement(By.xpath("//*[@id='signupForm']/div[6]/div/textarea"));
		WebElement activityaddress = driver.findElement(By.xpath("//*[@id='signupForm']/div[8]/div/input"));
		WebElement activityfield = driver.findElement(By.cssSelector("#extend_field > div > button"));
		
		activityName.sendKeys("活动-" + df.format(new Date()));
		
		for (int i = 0; i < 2; i++) {
			activityLabel.click();
			Thread.sleep(1000);
			WebElement labelName = driver.findElement(By.cssSelector("#tag > div > div > div.modal-body > div > input"));
			labelName.clear();
			labelName.sendKeys("标签-"+i+"-"+date);
			WebElement labelSub = driver.findElement(By.cssSelector("#addTag"));
			labelSub.click();
			Thread.sleep(1000);
		}
		
		
		activityBegin.sendKeys(betime);
		activityEnd.sendKeys(endtime);
		activityContent.sendKeys("活动内容");
		activityRule.sendKeys("活动规则");
		activityaddress.sendKeys("活动地址");
		Select add1 = new Select(driver.findElement(By.xpath("//*[@id='signupForm']/div[7]/div/div[1]/select")));
		add1.selectByIndex(1);
		Thread.sleep(1000);
		Select add2 = new Select(
				driver.findElement(By.cssSelector("#signupForm > div:nth-child(8) > div > div:nth-child(2) > select")));
		add2.selectByValue("52");
		Thread.sleep(1000);
		Select add3 = new Select(
				driver.findElement(By.cssSelector("#signupForm > div:nth-child(8) > div > div:nth-child(3) > select")));
		add3.selectByValue("500");
		
		for (int i = 0; i < 2; i++) {
			activityfield.click();
			Thread.sleep(1000);
			WebElement fieldName = driver.findElement(By.cssSelector("#myModal > div > div > div.modal-body > div > input:nth-child(2)"));
			WebElement fieldVal = driver.findElement(By.cssSelector("#myModal > div > div > div.modal-body > div > input:nth-child(4)"));
			WebElement fieldSub = driver.findElement(By.cssSelector("#addField"));
			fieldName.clear();
			fieldVal.clear();
			fieldName.sendKeys("字段-"+i+"-"+date);
			fieldVal.sendKeys();
			fieldSub.click();
			Thread.sleep(1000);
		}
		
		for (int i = 0; i < 2; i++) {
			WebElement activityimg = driver
					.findElement(By.cssSelector("#signupForm > div:nth-child(11) > div > div > div > img"));
			activityimg.click();
			Thread.sleep(1000);
			WebElement activityimg_inp = driver.findElement(By.cssSelector("#thumb"));
			if (i == 0) {
				activityimg_inp.sendKeys("C:\\Users\\陆石勤\\Desktop\\img\\t01a690072bc544b4a2.jpg");
			}else{
				activityimg_inp.sendKeys("C:\\Users\\陆石勤\\Desktop\\img\\t01432a78675d12766b.jpg");
			}
			Thread.sleep(1000);

			WebElement activitysubmit = driver.findElement(By.cssSelector("#addImage"));
			activitysubmit.click();
			Thread.sleep(1000);
		}


//		Select activitygift = new Select(
//				driver.findElement(By.cssSelector("#signupForm > div:nth-child(13) > div > div > select")));
//		activitygift.selectByIndex(1);

		WebElement activitygift_rules = driver.findElement(By.cssSelector("#prize_rules"));
		activitygift_rules.sendKeys("奖品获取规则");
		WebElement activitygiftadd = driver.findElement(By.cssSelector("#signupForm > div.form-group.col-sm-12.text-center > button > i"));

		for (int i = 0; i < 3; i++) {
			activitygiftadd.click();	
			Thread.sleep(1000);

			WebElement activitygift_name = driver
					.findElement(By.cssSelector("#input_gift_name"));
			WebElement activitygift_img = driver
					.findElement(By.cssSelector("#prize_photo"));
			WebElement activitygift_num = driver
					.findElement(By.cssSelector("#prize > div > div > div.modal-body > div:nth-child(4) > input"));
			activitygift_name.clear();
			activitygift_img.clear();
			activitygift_num.clear();
			Select activitygift_inven = new Select(driver.findElement(
					By.cssSelector("#prize > div > div > div.modal-body > div:nth-child(5) > select")));
			
			switch (i) {
			case 0:
				activitygift_name.sendKeys("一等奖");
				activitygift_img.sendKeys("C:\\Users\\陆石勤\\Desktop\\img\\p3.jpg");
				activitygift_num.sendKeys("1");
				activitygift_inven.selectByIndex(0);
				break;
			case 1:
				activitygift_name.sendKeys("二等奖");
				activitygift_img.sendKeys("C:\\Users\\陆石勤\\Desktop\\img\\p1.jpg");
				activitygift_num.sendKeys("20");
				activitygift_inven.selectByIndex(0);
				break;

			default:
				activitygift_name.sendKeys("三等奖");
				activitygift_img.sendKeys("C:\\Users\\陆石勤\\Desktop\\img\\p2.jpg");
				activitygift_num.sendKeys("40");
				activitygift_inven.selectByIndex(1);
				break;
			}

			Thread.sleep(2000);
			WebElement activitygift_sub = driver.findElement(By.cssSelector("#addPrize"));
			activitygift_sub.click();

		}

		Thread.sleep(2000);
		WebElement activity_submit = driver.findElement(By.cssSelector("#signupForm > div:nth-child(21) > button"));
		activity_submit.click();
		Thread.sleep(2000);
	}

	/**
	 * 添加班级页面
	 * 
	 * @throws InterruptedException
	 */
	public void classSend() throws InterruptedException {
		Thread.sleep(1000);
		WebElement className = driver.findElement(By.cssSelector("#name"));
		WebElement classBegin = driver.findElement(By.cssSelector("#start_at"));
		WebElement classEnd = driver.findElement(By.cssSelector("#end_at"));
		className.sendKeys("班级-" + df.format(new Date()));
		classBegin.sendKeys(betime);
		classEnd.sendKeys(year + "-" + month + "-" + date2 + " " + "00:00:00");

		Thread.sleep(2000);
		WebElement classSubmit = driver
				.findElement(By.cssSelector("#signupForm > div.form-group.text-center > button"));
		classSubmit.click();
	}
	
	/**
	 * 添加作业页面
	 * @throws InterruptedException
	 */
	public void taskSend() throws InterruptedException{
		Thread.sleep(1000);
		WebElement taskName = driver.findElement(By.cssSelector("#name"));
		taskName.clear();
		WebElement taskImg = driver.findElement(By.cssSelector("#add_pic > img"));
		taskImg.click();
		Thread.sleep(1000);
		WebElement taskImg_put = driver.findElement(By.cssSelector("#thumb"));
		taskImg_put.sendKeys("C:\\Users\\陆石勤\\Desktop\\img\\t01a690072bc544b4a2.jpg");
		Thread.sleep(1000);
		WebElement taskImg_sub = driver.findElement(By.cssSelector("#addField"));
		taskImg_sub.click();
		WebElement taskMain = driver.findElement(By.cssSelector("#description"));
		WebElement taskBegin = driver.findElement(By.cssSelector("#start_at"));
		WebElement taskEnd = driver.findElement(By.cssSelector("#end_at"));
		
		taskName.sendKeys("作业-"+df.format(new Date()));
		taskMain.sendKeys("作业描述-"+df.format(new Date()));
		taskBegin.sendKeys(betime);
		taskEnd.sendKeys(endtime);
		
		Thread.sleep(1000);
		WebElement taskSubmit = driver.findElement(By.cssSelector("#signupForm > div:nth-child(7) > div > button"));
		taskSubmit.click();
	}

}
